[gd_scene load_steps=2 format=3 uid="uid://dsy6xt2bk2eto"]

[sub_resource type="GDScript" id="GDScript_143yq"]
script/source = "extends CanvasLayer

@onready var container = $entries_container
@onready var template = $entries_container/entry_template

func show_leaderboard():
	# Clear previous entries
	for child in container.get_children():
		if child != template:
			child.queue_free()
	
	var path = \"user://leaderboard.json\"
	var data: Array = []
	
	if FileAccess.file_exists(path):
		var file = FileAccess.open(path, FileAccess.READ)
		if file:
			var parsed = JSON.parse_string(file.get_as_text())
			if parsed is Array:
				data = parsed
			file.close()
	
	# Sort descending by orbs using sort() and lambda
	data.sort_custom(lambda a, b: int(b[\"orbs\"]) - int(a[\"orbs\"]))
	
	# Populate entries
	for entry in data:
		var lbl = template.duplicate()
		lbl.visible = true
		lbl.text = str(entry[\"name\"]) + \" : \" + str(entry[\"orbs\"])
		container.add_child(lbl)
"

[node name="leaderboard" type="CanvasLayer"]
layer = 2
script = SubResource("GDScript_143yq")

[node name="ColorRect" type="ColorRect" parent="."]
offset_left = -50.0
offset_right = 1179.0
offset_bottom = 655.0
color = Color(0, 0, 0, 1)

[node name="RichTextLabel" type="RichTextLabel" parent="."]
offset_left = 219.0
offset_top = 51.0
offset_right = 968.0
offset_bottom = 152.0
theme_override_font_sizes/normal_font_size = 70
bbcode_enabled = true
text = "[center]LEADERBOARD
"

[node name="close_button" type="Button" parent="."]
offset_left = 1092.0
offset_top = 6.0
offset_right = 1147.0
offset_bottom = 59.0
theme_override_font_sizes/font_size = 30
text = "X"

[node name="entries_container" type="VBoxContainer" parent="."]
offset_left = 374.0
offset_top = 170.0
offset_right = 774.0
offset_bottom = 635.0

[node name="entry_template" type="Label" parent="entries_container"]
visible = false
layout_mode = 2
